on: push
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: iterative/setup-cml@v1
      - run: |
          cml runner
          --cloud=aws \
          --cloud-region=eu-west-1 \
          --cloud-type=g4dn.2xlarge \
          --cloud-hdd-size=250 \
          --cloud-spot=false \
          --cloud-aws-subnet=subnet-eaf6c38c14583c32d \
          --cloud-aws-security-group=cml-runner-sg\
          --labels=cml-test-gpu \
          --cloud-metadata="Runner=CML" \
          --cloud-metadata="Application=Testing" \
          --cloud-metadata="Team=ML" \
          --cloud-metadata="Environment=Development" \
          --idle-timeout=1000\
          --single
